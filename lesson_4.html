<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lesson 4</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="tutorial_style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">QConut - Training</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about_qconut.html">About</a>
</li>
<li>
  <a href="training_overview.html">Training Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lesson_1.html">Lesson 1</a>
    </li>
    <li>
      <a href="lesson_2.html">Lesson 2</a>
    </li>
    <li>
      <a href="lesson_3.html">Lesson 3</a>
    </li>
    <li>
      <a href="lesson_4.html">Lesson 4</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Use Cases
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="usecase_groundtruth.html">Use Case - Ground Truth</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/livelihoods-and-landscapes">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="contact.html">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lesson 4</h1>

</div>


<div id="managing-remote-devices" class="section level2">
<h2>Managing Remote Devices</h2>
<p>This lesson provides instructions on how to manage QGIS data collection projects on multiple remote devices (e.g. tablets or mobile phones). This workflow enables syncing of data collected on remote devices using <a href="https://qfield.org">QField</a> with a central dataset / database, updating data collection projects on remote devices, and “cleaning” data from remote devices. The application <a href="https://syncthing.net">Syncthing</a> is used to share data between remote devices and a central computer.</p>
</div>
<div id="syncthing" class="section level2">
<h2>Syncthing</h2>
<p><a href="https://syncthing.net">Syncthing</a> is an open source file synchronisation application. Syncthing compares a shared file on different devices (e.g. a desktop and a tablet); if a change in the file on one device is detected (e.g. a new survey has been undertaken using QField) these changes will be synced across all linked devices. Data transferred using Syncthing is secured using TLS encryption.</p>
<p>There is an <a href="https://docs.syncthing.net/users/faq.html">FAQ</a> for Syncthing and extensive <a href="https://docs.syncthing.net/intro/index.html">documentation</a>.</p>
<div id="downloading-syncthing" class="section level3">
<h3>Downloading Syncthing</h3>
<p>The Syncthing desktop application can be downloaded from the <a href="https://syncthing.net/downloads/">Syncthing downloads</a> page. There are versions for Windows, MacOS, and Linux. If you are working on a Mac Syncthing can also be installed via <a href="https://formulae.brew.sh/formula/syncthing">homebrew</a>. The desktop application should be downloaded onto the device which will be used for central data management and syncing data collected in the field on remote devices with the central dataset / database.</p>
<p>The Android Syncthing application can be downloaded from <a href="https://play.google.com/store/apps/details?id=com.nutomic.syncthingandroid">Google Play</a>. This application should be downloaded on all remote devices which are used for data collection. When setting up Syncthing on your Android device grant it permissions to access photos, media, and files on your device.</p>
</div>
<div id="configuring-devices" class="section level3">
<h3>Configuring Devices</h3>
<p>For Syncthing to be able sync files across two or more devices each device must be configured with the device ID of the device it is sharing with. A device ID is a unique identifier for each device that is generated when Syncthing is first started. To find your device ID go to <em>Actions</em> then <em>Show ID</em>. This will bring up your device ID and a QR code. You can share your device ID with another trusted device to enable file syncronisation.</p>
<center>
<div class="figure">
<img src="img/syncthing_actions.png" alt="Find device ID" width="640" />
<p class="caption">Find device ID</p>
</div>
</center>
<p>Once you have the device ID for the device you wish to share a file with go to <em>Add Remote Device</em> and enter the device ID. To connect your desktop application (<em>Central</em> - as this will be the device that manages QGIS data collection projects across multiple remote devices) to your remote device (<em>Tablet 1</em>) go to <em>Add Remote Device</em> on your desktop application and enter the device ID of <em>Tablet 1</em>.</p>
<center>
<div class="figure">
<img src="img/syncthing_add_remote_device.png" alt="Add remote device" width="640" />
<p class="caption">Add remote device</p>
</div>
</center>
<center>
<div class="figure">
<img src="img/syncthing_add_remote_device_3.png" alt="Enter the device ID of the remote device" width="640" />
<p class="caption">Enter the device ID of the remote device</p>
</div>
</center>
<p>On <strong>Tablet 1</strong>, when prompted, click <em>Add Device</em> to link up with <em>Central</em>. You can chose to give this device a name; here, we will call it <em>Central</em> as this will be the device that manages QGIS data collection projects across multiple remote devices.</p>
<center>
<div class="figure">
<img src="img/syncthing_tablet_add_device.png" alt="Add Central device when prompted on your remote device" width="640" />
<p class="caption">Add Central device when prompted on your remote device</p>
</div>
</center>
<p>If both your devices are correctly connected you should see each device listed under <em>Remote Devices</em>.</p>
<center>
<div class="figure">
<img src="img/syncthing_tablet_device_added.png" alt="Central device successfully linked as a remote device" width="640" />
<p class="caption">Central device successfully linked as a remote device</p>
</div>
</center>
</div>
<div id="sharing-folders" class="section level3">
<h3>Sharing Folders</h3>
<p>There are multiple ways to share folders across devices. Here, we assume a QGIS project has been created to enable data collection using the QField mobile GIS application (see Lessons 1, 2, and 3). The QGIS project we will work with in this tutorial is called <em>syncthing_demo.qgs</em> and is in a folder named <em>export_syncthing_demo</em>.</p>
<p>You can add the folder to Syncthing on the <em>Central</em> device by clicking <em>Add Folder</em>, entering the file path to the folder, and giving the folder an informative <em>Folder ID</em>.</p>
<center>
<div class="figure">
<img src="img/syncthing_add_folder.png" alt="Add folder" width="640" />
<p class="caption">Add folder</p>
</div>
</center>
<center>
<div class="figure">
<img src="img/syncthing_add_folder_2.png" alt="Shared folder details" width="640" />
<p class="caption">Shared folder details</p>
</div>
</center>
<p>Click on the <em>Sharing</em> tab and select the remote device to share with (here it is <em>Tablet 1</em>). If you have connected your folder to Syncthing before the devices are linked you can chose to share the folder at the time the device connection is established.</p>
<center>
<div class="figure">
<img src="img/syncthing_add_folder_sharing.png" alt="Sharing settings" width="640" />
<p class="caption">Sharing settings</p>
</div>
</center>
<p>There are options you can set for <em>File Versioning</em>; ignore them for now. Finally, go to <em>Advanced</em> and make sure the <em>Watch for Changes</em> checkbox is ticked, the <em>Folder Type</em> is <em>Send and Receive</em>, and the <em>Permissions Ignore</em> checkbox is ticked. Click save.</p>
<center>
<div class="figure">
<img src="img/syncthing_add_folder_3.png" alt="Advanced settings for sharing folders" width="640" />
<p class="caption">Advanced settings for sharing folders</p>
</div>
</center>
<p>Now go to your remote device (<em>Tablet 1</em>) and when prompted choose to <em>Add</em> the folder.</p>
<center>
<div class="figure">
<img src="img/syncthing_tablet_add_folder.png" alt="Advanced settings for sharing folders" width="640" />
<p class="caption">Advanced settings for sharing folders</p>
</div>
</center>
<p>Go through the same process as you did on your desktop computer under the <em>Advanced</em> tab and make sure the <em>Watch for Changes</em> checkbox is ticked, the <em>Folder Type</em> is <em>Send and Receive</em>, and the <em>Permissions Ignore</em> checkbox is ticked. Click save.</p>
<center>
<div class="figure">
<img src="img/syncthing_tablet_add_folder_advanced_settings.png" alt="Advanced settings for sharing folders" width="640" />
<p class="caption">Advanced settings for sharing folders</p>
</div>
</center>
<p>You should now see <em>syncthing_demo</em> listed as a folder on your remote device (<em>Tablet 1</em>).</p>
<center>
<div class="figure">
<img src="img/syncthing_tablet_add_folder_synced.png" alt="Advanced settings for sharing folders" width="640" />
<p class="caption">Advanced settings for sharing folders</p>
</div>
</center>
</div>
</div>
<div id="collect-data-using-shared-file" class="section level2">
<h2>Collect Data Using Shared File</h2>
<p>Open QField then <em>Open local project</em> and select <em>syncthing_demo</em>.</p>
<center>
<video width="500px" controls>
<source src="video/syncthing_qfield_load_project.mp4" type="video/mp4">
</video>
</center>
<p>Enter <em>edit mode</em> and select the <em>syncthing_demo</em> dataset and digitise some features and enter attribute values into the form. Close the QField application.</p>
<center>
<video width="500px" controls>
<source src="video/syncthing_qfield_add_feature.mp4" type="video/mp4">
</video>
</center>
</div>
<div id="sync-data-to-central-device" class="section level2">
<h2>Sync Data to Central Device</h2>
<p>On your <em>Central</em> device (which has QGIS installed) go to the folder <em>export_syncthing_demo</em> and open <em>syncthing_demo.qgs</em> in QGIS. You should see the features you digitised using QField appear in the map canvas. You can also use the <em>QFieldSync</em> plugin introduced in lesson 2 to sync data collected on QGIS projects on remote devices with a central dataset.</p>
<center>
<div class="figure">
<img src="img/syncthing_qgis_synced.png" alt="Data collected using remote device synced to central device and opened in QGIS." width="640" />
<p class="caption">Data collected using remote device synced to central device and opened in QGIS.</p>
</div>
</center>
</div>
<div id="cleaning-data-and-projects-on-remote-devices" class="section level2">
<h2>Cleaning data and projects on remote devices</h2>
<p>As the QGIS project files on the <em>Central</em> device are shared with the remote devices (e.g. <em>Tablet 1</em>), you can make changes to the shared files on the <em>Central</em> device which will be updated on remote devices. For example, after you have synced the data collected using QField on <em>Tablet 1</em> with your central dataset you could delete the QGIS project and associated files in the shared folder and replace them with a <em>clean</em> QGIS project. This <em>clean</em> QGIS project could be a copy of the previous QGIS project with the same attribute table and form but without any data in the attribute table. This is useful if you have sensitive data that you wish to store on remote devices for only a short a period of time. Alternatively, you could update your data collection form and want to provide this updated form on your remote devices.</p>
<p>Try deleting the QGIS project and files in the shared folder on your <em>Central</em> device and add a new QGIS project. See if this updates on your remote device <em>Tablet 1</em>.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
